(function(h){function o(b,c){var a,e,f,d,j,c=c||{};this.mesh=b;this.names=[];this.maps={};this.options=$.extend(!0,this.options||{},g.options,c);f=h.to_array(this.mesh.geometry.morphTargets);for(a=0,e=f.length;a<e;a++)d=f[a],d=d.name,j=k(d),d=j.name,j=j.number,d!==l&&(this.maps.hasOwnProperty(d)!==!0&&(this.maps[d]=[],this.names.push(d)),d=this.maps[d],d.push({index:a,number:j}));for(a=0,e=this.names.length;a<e;a++)d=this.names[a],d=this.maps[d],d.sort(p);this.animators={};this.animatorNames=[];this.animatingNames=
[];this.stabilize()}function q(b,c){var a=this.names,e,f,d,g=h.index_of_value(a,b);g!==-1?(e=this.animators,f=this.animatorNames,d=this.animatingNames,b=a[g],e.hasOwnProperty(b)!==!0&&(e[b]=new i.Instance(this,b,this.options),f.push(b)),h.array_cautious_add(d,b),a=e[b],a.play(c)):c&&(c.solo===!0&&this.clear_all({duration:c.durationClear}),typeof c.callback==="function"&&c.callback());return this}function r(b,c){var a=this.animators[b];a instanceof i.Instance&&a.stop(c);return this}function s(b,c){var a,
e,f=this.animatingNames,d;if(f.length>0){c=h.to_array(c);for(a=0,e=f.length;a<e;a++)d=f[a],h.index_of_value(c,d)===-1&&this.stop(d,b)}return this}function t(b,c){var a=this.animators[b];a instanceof i.Instance&&a.clear(c);return this}function u(b,c){var a,e,f=this.animatingNames,d;if(f.length>0){b=h.to_array(b);for(a=0,e=f.length;a<e;a++)d=f[a],h.index_of_value(b,d)!==-1&&this.clear(d,c)}return this}function v(b,c){var a,e,f=this.animatingNames,d;if(f.length>0){c=h.to_array(c);for(a=0,e=f.length;a<
e;a++)d=f[a],h.index_of_value(c,d)===-1&&this.clear(d,b)}return this}function w(b){h.array_cautious_remove(this.animatingNames,b)}function x(){var b,c,a=this.mesh.geometry.morphTargets||[],e,f=!this.stable;if(f===!0){for(b=0,c=a.length;b<c;b++)if(e=a[b],e=k(e.name),e.name===l){f=!1;break}if(a.length>0&&(f===!0||a.length<m)){n.call(this);for(b=a.length,c=m;b<c;b++)n.call(this)}this.stable=!0}}function n(){var b,c,a=this.mesh,e=a.geometry,f=e.vertices,d,g=a.morphTargetInfluences.length,h={name:l+"_"+
g,vertices:[]},i=h.vertices;for(b=0,c=f.length;b<c;b++)d=f[b],i.push(d.clone());e.morphTargets.push(h);a.morphTargetInfluences.push(0);a.morphTargetDictionary[h.name]=g}function p(b,c){return b.number-c.number}function k(b){var c={name:b,number:0},a,e;a=b.lastIndexOf("_");if(a!==-1&&(e=parseFloat(b.substr(a+1)),h.is_number(e)))c.name=b.substr(0,a),c.number=e;return c}h.shared=h.shared||{};var g={},i,m=5,l="morph_stability";h.asset_register("js/kaiopua/core/Morphs.js",{data:g,requirements:["js/kaiopua/core/MorphAnimator.js"],
callbacksOnReqs:function(b){i=b;g.options={duration:1E3};g.Instance=o;g.Instance.prototype.constructor=g.Instance;g.Instance.prototype.play=q;g.Instance.prototype.stop=r;g.Instance.prototype.stop_all=s;g.Instance.prototype.clear=t;g.Instance.prototype.clear_only=u;g.Instance.prototype.clear_all=v;g.Instance.prototype.remove=w;g.Instance.prototype.stabilize=x;g.get_morph_name_data=k},wait:!0})})(KAIOPUA);
