(function(c){function m(a){e.Instance.call(this,a);this.utilVec31Start=new THREE.Vector3;this.axisTarget=n.cardinalAxes.up.clone();this.axis=(new THREE.Vector3).copy(this.axisTarget);this.acceleration=0;this.accelerationDamping=o;this.speedLerp=p;this.speedMax=f;this.speedMin=i;this.angle=this.radius=this.speed=0;this.originTarget=new THREE.Vector3;this.origin=new THREE.Vector3;this.positionOffset=new THREE.Vector3;this.rotationBase=new THREE.Quaternion;this.rotationOffset=new THREE.Quaternion;this.forApply=
{origin:new THREE.Vector3,positionOffset:new THREE.Vector3,rotationBase:new THREE.Quaternion,rotationOffset:new THREE.Quaternion};this.reset()}function q(){var a=this.forApply;a.origin.set(0,0,0);a.positionOffset.set(0,0,0);a.rotationBase.set(0,0,0,1);a.rotationOffset.set(0,0,0,1)}function r(a){var b=this.utilVec31Start,g,a=a||{};a.axis&&this.axisTarget.copy(a.axis);a.origin?this.originTarget.copy(a.origin):(b.copy(this.object.position).normalize(),g=h.angle_between_vectors(b,this.axisTarget),b=this.object.position.length(),
g=Math.sin(g)*b/Math.sin(Math.PI*0.5),b=Math.sqrt(Math.pow(b,2)-Math.pow(g,2)),this.originTarget.copy(this.axis).multiplyScalar(b));this.radius=c.is_number(a.radius)?a.radius:this.object.position.distanceTo(this.originTarget);this.positionOffset.z=this.radius;this.angle=0;this.rotationBase.copy(this.object.quaternion);this.accelerationDamping=c.is_number(a.accelerationDamping)?a.accelerationDamping:this.accelerationDamping;this.speedLerp=c.is_number(a.speedLerp)?a.speedLerp:this.speedLerp;this.speedMax=
c.is_number(a.speedMax)?a.speedMax:c.is_number(a.speed)?a.speed:f;this.speedMin=c.is_number(a.speedMin)?a.speedMin:c.is_number(a.speed)?a.speed:i;this.speed=Math.random()*(this.speedMax-this.speedMin)+this.speedMin;a.snapToInitial===!0&&(this.axis.copy(this.axisTarget),this.origin.copy(this.originTarget));d.Instance.prototype.supr.start.call(this,a)}function s(){if(this.speed!==0)this.reset(),this.acceleration+=this.speed,h.lerp_snap(this.origin,this.originTarget,this.speedLerp,j),this.positionOffset.z!==
this.radius&&(this.positionOffset.z+=this.acceleration*(this.radius-this.positionOffset.z)),this.angle=k.rad_between_PI(this.angle+this.acceleration),h.lerp_snap(this.axis,this.axisTarget,this.speedLerp,j),this.rotationOffset.setFromAxisAngle(this.axis,this.angle),this.acceleration*=this.accelerationDamping,this.integrate(this)}function t(a){var b=this.forApply;a.origin&&b.origin.addSelf(a.origin);a.positionOffset&&b.positionOffset.addSelf(a.positionOffset);a.rotationBase&&b.rotationBase.multiplySelf(a.rotationBase);
a.rotationOffset&&b.rotationOffset.multiplySelf(a.rotationOffset)}function u(){var a;if(this.parent instanceof e.Instance!==!0&&this.object instanceof THREE.Object3D)a=this.forApply,l.object_orbit_source(this.object,a.origin,a.positionOffset,a.rotationBase,a.rotationOffset)}var n=c.shared=c.shared||{},d={},e,k,h,l,o=0.9,p=0.01,f=2.0E-5,i=1.0E-5,j=0.01;c.asset_register("js/kaiopua/model/OrbitUpdater.js",{data:d,requirements:["js/kaiopua/core/PropertyUpdater.js","js/kaiopua/utils/MathHelper.js","js/kaiopua/utils/VectorHelper.js",
"js/kaiopua/utils/ObjectHelper.js"],callbacksOnReqs:function(a,b,c,f){e=a;k=b;h=c;l=f;d.Instance=m;d.Instance.prototype=new e.Instance;d.Instance.prototype.constructor=d.Instance;d.Instance.prototype.supr=e.Instance.prototype;d.Instance.prototype.start=r;d.Instance.prototype.step=s;d.Instance.prototype.reset=q;d.Instance.prototype.integrate=t;d.Instance.prototype.apply=u},wait:!0})})(KAIOPUA);
