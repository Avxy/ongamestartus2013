var KAIOPUA=(function(r){window.console=window.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};var S=r.shared=r.shared||{};S.domElements={};S.supports={webGL:true};S.throttled={};S.spawns={};S.pointers=[];S.originLink=window.location.pathname.toString();S.pathToIcons="img/";S.pathToAssets="asset/";S.frameRateMax=60;S.frameRateMin=20;S.time=new Date().getTime();S.timeLast=S.time;S.timeDeltaExpected=1000/60;S.timeDeltaModDec=Math.pow(10,2);S.pointerWheelSpeed=120;S.pointerHoldPositionShift=10;S.pointerInGame=true;S.throttleTimeShort=S.timeDeltaExpected*3;S.throttleTimeMedium=100;S.throttleTimeLong=250;S.throttleTimeLong=250;S.focused=true;S.errorString="error";S.errorTypeGeneral="General";S.errorTypeWebGLBrowser="WebGLBrowser";S.errorTypeWebGLComputer="WebGLComputer";S.errorTypes=[S.errorTypeGeneral,"WebGLBrowser","WebGLComputer"];S.errorTypesOnlyOnce=["WebGLBrowser","WebGLComputer"];S.webGLNames=["webgl","experimental-webgl","webkit-3d","moz-webgl"];S.fadeBetweenSections=false;S.domFadeDuration=500;S.domCollapseDuration=500;S.domFadeEasing="easeInOutCubic";S.domCollapseEasing="easeInOutCubic";S.screenWidth=0;S.screenHeight=0;S.screenViewableWidth=0;S.screenViewableHeight=0;S.screenOffsetTop=0;S.screenOffsetBottom=0;S.screenOffsetLeft=0;S.screenOffsetRight=0;var O={},F={},s,ak,V,aZ,y,ax,a5,aj,aI=false,aM=false,A=false,av=false,aG=false,aL=false,a8=500,aE=["js/lib/RequestAnimationFrame.js","js/lib/RequestInterval.js","js/lib/RequestTimeout.js","js/lib/signals.min.js","js/lib/jquery-1.8.3.min.js"],a9=["js/lib/hammer.custom.js","js/lib/bootstrap.min.js","js/lib/jquery.easing-1.3.min.js","js/lib/jquery.throttle-debounce.custom.min.js","js/lib/jquery.placeholdme.js"],aU=["js/kaiopua/ui/UI.js","js/kaiopua/utils/KeyHelper.js"],ap=["js/lib/three/three.min.js","js/lib/Tween.custom.min.js"],R=["js/lib/three/ThreeOctree.min.js","js/lib/three/postprocessing/ShaderExtras.js","js/lib/three/postprocessing/EffectComposer.js","js/lib/three/postprocessing/RenderPass.js","js/lib/three/postprocessing/MaskPass.js","js/lib/three/postprocessing/ShaderPass.js"],h=["js/kaiopua/core/Scene.js","js/kaiopua/core/CameraControls.js"],an=["js/kaiopua/sections/Launcher.js"],P=["js/kaiopua/sections/Start.js"];$LAB.script(aE).wait().script(a9).wait(at);function at(){console.log("[ KAI 'OPUA <3 ]");S.domElements.$game=$("#game");S.supports.pointerEvents=Modernizr.testProp("pointerEvents");S.signals={onError:new signals.Signal(),onFocusLost:new signals.Signal(),onFocusGained:new signals.Signal(),onKeyPressed:new signals.Signal(),onKeyReleased:new signals.Signal(),onGameInput:new signals.Signal(),onWindowResized:new signals.Signal(),onUpdated:new signals.Signal(),onWorkerReset:new signals.Signal(),onWorkerTaskStarted:new signals.Signal(),onWorkerTaskCompleted:new signals.Signal(),onWorkerTasksCompleted:new signals.Signal(),onLoadItemCompleted:new signals.Signal(),onLoadListCompleted:new signals.Signal(),onLoadAllCompleted:new signals.Signal(),onAssetReady:new signals.Signal(),onGameStateChange:new signals.Signal(),onGamePlayable:new signals.Signal(),onGameReady:new signals.Signal(),onGamePaused:new signals.Signal(),onGameResumed:new signals.Signal(),onGameUpdated:new signals.Signal(),onGameStarted:new signals.Signal(),onGameStartedCompleted:new signals.Signal(),onGameStopped:new signals.Signal(),onGameStoppedCompleted:new signals.Signal(),onGamePointerLeft:new signals.Signal(),onGamePointerEntered:new signals.Signal(),onGamePointerMoved:new signals.Signal(),onGamePointerTapped:new signals.Signal(),onGamePointerDoubleTapped:new signals.Signal(),onGamePointerHeld:new signals.Signal(),onGamePointerDragStarted:new signals.Signal(),onGamePointerDragged:new signals.Signal(),onGamePointerDragEnded:new signals.Signal(),onGamePointerWheel:new signals.Signal()};$(document).on("keydown",ag).on("keyup",ab);S.throttled.reposition_pointer=$.throttle(S.throttleTimeShort,T);S.throttled.on_window_resized=$.throttle(S.throttleTimeLong,af);$(window).on("mousemove",S.throttled.reposition_pointer).on("blur",k).on("focus",aY).on("resize",S.throttled.on_window_resized);window.onerror=aQ;S.signals.onFocusLost.add(function(){if(aG!==true){aL=true}ah(true)});S.signals.onFocusGained.add(function(){if(aL===true){aL=false;a3(true)}});O.active=false;O.listCount=0;O.lists=[];O.listLocations={};O.listLoaded={};O.listMessages={};O.listCallbacks={};O.loading=[];O.loadingListIDs=[];O.started=[];O.loaded=[];O.loadingOrLoaded=[];O.listCurrent="";O.loadTypeBase="script";O.tips=[];M(aE);M(a9);F.taskCount=0;F.tasksStarted=[];F.tasksCompleted=[];a0();r.type=ac;r.is_number=a1;r.is_array=be;r.is_image=b;r.is_image_ext=a2;r.is_event=aA;r.extend=aq;r.time_test=L;r.to_array=a4;r.ensure_not_array=c;r.array_cautious_add=m;r.array_cautious_remove=aN;r.array_random_value=am;r.array_random_value_remove=aS;r.index_of_value=W;r.last_index_of_value=az;r.indices_of_value=t;r.index_of_values=x;r.index_of_property=aR;r.indices_of_property=ar;r.index_of_properties=f;r.dom_extract=aH;r.dom_generate_image=aa;r.dom_ignore_pointer=z;r.dom_fade=aW;r.dom_collapse=aw;r.get_pointer=ao;r.reposition_pointer=T;r.worker_reset=a0;r.worker_task_start=q;r.worker_task_complete=aP;r.load=i;r.get_is_loaded=p;r.get_is_loading=w;r.get_is_loading_or_loaded=aJ;r.get_asset_path=N;r.get_ext=aO;r.add_default_ext=v;r.remove_ext=E;r.get_alt_path=a;r.asset_register=ad;r.asset_require=a7;r.asset_ready=ae;r.set_asset=C;r.get_asset=au;r.get_asset_data=d;r.set_section=H;r.start=u;r.stop=aK;r.resume=a3;r.pause=ah;Object.defineProperty(r,"paused",{get:function(){return aG}});Object.defineProperty(r,"started",{get:function(){return av}});Object.defineProperty(r,"setup",{get:function(){return aI}});Object.defineProperty(r,"playable",{get:function(){return aM}});Object.defineProperty(r,"ready",{get:function(){return A},set:function(bf){if(A!==bf){A=bf;S.signals.onGameReady.dispatch(A);S.signals.onGameStateChange.dispatch(A)}}});Object.defineProperty(r,"focusLost",{get:function(){return aL}});$(window).ready(function(){$(window).trigger("resize");Q();a7(aU,bd,true)})}function bd(bl,bm){var bi,bf,bg,bh,bk;aZ=bl;V=bm;try{if(!window.WebGLRenderingContext){bk=S.errorTypeWebGLBrowser}else{bg=document.createElement("canvas");for(bi=0,bf=S.webGLNames.length;bi<bf;bi+=1){bh=bg.getContext(S.webGLNames[bi]);if(bh){break}}if(!bh){bk=S.errorTypeWebGLComputer}}}catch(bj){bk=S.errorTypeWebGLBrowser}S.errorCurrent=bk;if(typeof S.errorCurrent!=="undefined"){S.supports.webGL=false;S.signals.onGameStateChange.dispatch();aQ(S.errorCurrent)}else{D()}}function D(){r.asset_require(ap,[Z],true)}function Z(){r.asset_require(R,[J,aF],true)}function aF(){r.asset_require(h,[a6,bb],true)}function bb(){r.asset_require(an,[ba,aX],true)}function aX(){r.asset_require(P,aT,true)}function J(){S.universeGravitySource=new THREE.Vector3(0,0,0);S.universeGravityMagnitude=new THREE.Vector3(0,-0.4,0);S.cardinalAxes={up:new THREE.Vector3(0,1,0),forward:new THREE.Vector3(0,0,1),right:new THREE.Vector3(-1,0,0)};S.renderer=new THREE.WebGLRenderer({clearColor:0,clearAlpha:0,maxLights:8});S.renderer.setSize(S.gameWidth,S.gameHeight);S.renderer.autoClear=false;S.renderTarget=new THREE.WebGLRenderTarget(S.gameWidth,S.gameHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter})}function a6(bf,bg){s=bf;ak=bg;S.scene=new s.Instance();S.sceneBG=new s.Instance();S.scene.fog=undefined;r.physics=S.scene.physics;S.camera=new THREE.PerspectiveCamera(60,S.gameWidth/S.gameHeight,1,20000);S.cameraBG=new THREE.PerspectiveCamera(60,S.gameWidth/S.gameHeight,1,20000);S.camera.useQuaternion=S.cameraBG.useQuaternion=true;S.cameraControls=new ak.Instance({camera:S.camera});S.cameraControls.onCameraMoved.add($.throttle(S.throttleTimeMedium,function(){S.domElements.$game.triggerHandler("mousemove")}));aj={bg:new THREE.RenderPass(S.sceneBG,S.cameraBG),env:new THREE.RenderPass(S.scene,S.camera),screen:new THREE.ShaderPass(THREE.ShaderExtras.screen)};aj.env.clear=false;aj.screen.renderToScreen=true;a5=new THREE.EffectComposer(S.renderer,S.renderTarget);a5.addPass(aj.bg);a5.addPass(aj.env);a5.addPass(aj.screen);S.domElements.$game.prepend(S.renderer.domElement);S.throttled.on_game_pointer_moved=$.throttle(S.throttleTimeShort,B);S.throttled.on_game_pointer_dragged=$.throttle(S.throttleTimeShort,true,K);S.domElements.$game.on("mouseleave",e).on("mouseenter",ai).on("mousemove",S.throttled.on_game_pointer_moved).on("tap",aC).on("doubletap",al).on("hold",g).on("dragstart",j).on("drag",S.throttled.on_game_pointer_dragged).on("dragend",X).on("mousewheel DOMMouseScroll",ay).on("contextmenu",aB);aI=true;af()}function ba(bf){y=bf;H(y)}function aT(bf){ax=bf;aM=true;S.signals.onGamePlayable.dispatch();S.signals.onGameStateChange.dispatch()}function H(bh,bj){var bi=S.fadeBetweenSections,bg=false,bf=function(){if(typeof S.sectionLast!=="undefined"){S.sectionLast.remove()}bh.show();S.section=bh;if(bi!==false){r.dom_fade({element:S.domElements.$uiBlocker})}a3();if(typeof bj!=="undefined"){bj.call()}};ah(true);if(typeof S.section!=="undefined"){bg=true;S.sectionLast=S.section;S.sectionLast.hide();if(bi!==false){r.dom_fade({element:S.domElements.$uiBlocker,opacity:1})}}S.section=undefined;if(typeof startedValue!=="undefined"){av=startedValue}if(typeof bh!=="undefined"){if(bi!==false&&bg===true){window.requestTimeout(function(){bf()},a8)}else{bf()}}}function u(){if(aM===true){if(av===false){av=true;S.signals.onGameStarted.dispatch();H(ax,function(){S.signals.onGameStartedCompleted.dispatch()})}else{a3()}}}function aK(){if(aM===true){av=false;S.signals.onGameStopped.dispatch();H(y,function(){S.signals.onGameStoppedCompleted.dispatch()})}}function ah(bf,bg){if(aG===false){aG=true;S.signals.onGamePaused.dispatch(bf,bg);Y()}}function a3(bf){if(aG===true&&(typeof S.errorCurrent==="undefined"||av!==true)){aG=false;S.signals.onGameResumed.dispatch(bf)}}function Q(){var bf,bg;window.requestAnimationFrame(Q);S.timeLast=S.time;S.time=new Date().getTime();bf=S.time-S.timeLast;bg=Math.round((bf/S.timeDeltaExpected)*S.timeDeltaModDec)/S.timeDeltaModDec;if(a1(bg)!==true){bg=1}S.signals.onUpdated.dispatch(bf,bg);if(aG!==true&&aI===true){TWEEN.update();if(r.physics){r.physics.update(bf,bg)}S.signals.onGameUpdated.dispatch(bf,bg);Y()}}function Y(){if(aI===true){S.cameraControls.update();S.cameraBG.quaternion.copy(S.camera.quaternion);S.renderer.setViewport(0,0,S.gameWidth,S.gameHeight);S.renderer.clear();a5.render()}}function ac(bf){return bf===null?bf+"":Object.prototype.toString.call(bf).slice(8,-1).toLowerCase()}function be(bf){return Object.prototype.toString.call(bf)==="[object Array]"}function a1(bf){return !isNaN(bf)&&isFinite(bf)&&typeof bf!=="boolean"}function b(bf){return(typeof bf!=="undefined"&&bf.hasOwnProperty("nodeName")&&bf.nodeName.toLowerCase()==="img")}function a2(bf){if(bf==="jpg"||bf==="jpeg"||bf==="png"||bf==="gif"||bf==="bmp"){return true}else{return false}}function aA(bf){return bf&&(bf.type&&(bf.target||bf.srcElement))}function aq(bf,bt,bv,bn){var bq,bo,bl,bi,bh,bu,bp,br,bm,bk,bj,bg,bs;if(typeof bf!=="undefined"){bt=r.type(bt)==="object"?bt:{};bl=Object.getOwnPropertyNames(bf);for(bq=0,bo=bl.length;bq<bo;bq++){bi=bl[bq];bh=Object.getOwnPropertyDescriptor(bf,bi);if(bt.hasOwnProperty(bi)){delete bt[bi]}Object.defineProperty(bt,bi,bh);if(bv===true){bh=Object.getOwnPropertyDescriptor(bt,bi);bu=bh.value;bp=ac(bu);if(bp==="object"||bp==="array"){bn=bn||{sources:[],copies:[]};br=bn.sources;bm=bn.copies;bk=W(br,bu);if(bk===-1){bg=br[br.length]=bu;bs=bm[bm.length]=(bp==="object"?{}:[]);if(bu===bf){bu[bi]=bs}bh.value=aq(bu,bs,true,bn)}else{bh.value=bm[bk]}Object.defineProperty(bt,bi,bh)}}}}return bt}function L(bj,bl,bk){var bi,bh,bg,bf;bl=a1(bl)&&bl>0?bl:1;bk=typeof bk==="string"?bk:"";bh=new Date().getTime();for(bi=0;bi<bl;bi++){bf=bj.call()}bg=new Date().getTime();console.log(bk," > time test ( x",bl,"): ",(bg-bh));return bf}function a4(bf){return bf?(be(bf)!==true?[bf]:bf):[]}function c(bg,bf){return be(bg)===true?bg[bf||0]:bg}function m(bl,bk){var bi,bf,bh,bg,bj=false;bl=a4(bl);bk=a4(bk);for(bi=0,bf=bk.length;bi<bf;bi++){bh=bk[bi];bg=W(bl,bh);if(bg===-1){bl.push(bh);bj=true}}return bj}function aN(bl,bj){var bi,bf,bh,bg,bk=false;bl=a4(bl);bj=a4(bj);for(bi=0,bf=bj.length;bi<bf;bi++){bh=bj[bi];bg=W(bl,bh);if(bg!==-1){bl.splice(bg,1);bk=true}}return bk}function am(bf){return bf[Math.round(Math.random()*(bf.length-1))]}function aS(bf){return bf.splice(Math.round(Math.random()*(bf.length-1)),1)[0]}function W(bi,bh){for(var bg=0,bf=bi.length;bg<bf;bg++){if(bh===bi[bg]){return bg}}return -1}function az(bh,bg){for(var bf=bh.length-1;bf>=0;bf--){if(bg===bh[bf]){return bf}}return -1}function t(bj,bh){var bi=[];for(var bg=0,bf=bj.length;bg<bf;bg++){if(bh===bj[bg]){bi.push(bg)}}return bi}function x(bi,bg){for(var bh=0,bf=bi.length;bh<bf;bh++){if(W(bg,bi[bh])!==-1){return bh}}return -1}function aR(bj,bi,bh){for(var bg=0,bf=bj.length;bg<bf;bg++){if(bh===bj[bg][bi]){return bg}}return -1}function ar(bk,bi,bh){var bj=[];for(var bg=0,bf=bk.length;bg<bf;bg++){if(bh===bk[bg][bi]){bj.push(bg)}}return bj}function f(bl,bk,bg){for(var bj=0,bf=bl.length;bj<bf;bj++){for(var bh=0,bi=bk.length;bh<bi;bh++){if(bg[bh]===bl[bj][bk[bh]]){return bj}}}return -1}function ao(bf){bf=bf||{};var bh=bf.identifier=(bf.identifier?bf.identifier:0),bg=S.pointers[bh];if(typeof bg==="undefined"){bg=S.pointers[bh]={};bg.id=bh;bg.x=bg.lx=S.screenWidth*0.5;bg.y=bg.ly=S.screenHeight*0.5;bg.deltaX=bg.deltaY=bg.angle=bg.distance=bg.distanceX=bg.distanceY=0;bg.direction="none"}return bg}function T(bh){S.timeSinceInteraction=0;var bj=r.get_pointer(bh),bg,bi,bf;if(bh){bg=bh.position;if(be(bg)&&bg[bj.id]){bg=bg[bj.id]}if(typeof bg==="undefined"){bi=document;bf=bi.body;bg={x:bj.x,y:bj.y};if(typeof bh.pageX!=="undefined"){bg.x=bh.pageX}else{if(typeof bh.clientX!=="undefined"){bg.x=bh.clientX+(bi&&bi.scrollLeft||bf&&bf.scrollLeft||0)-(bi&&bi.clientLeft||bf&&bf.clientLeft||0)}}if(typeof bh.pageY!=="undefined"){bg.y=bh.pageY}else{if(typeof bh.clientY!=="undefined"){bg.y=bh.clientY+(bi&&bi.scrollTop||bf&&bf.scrollTop||0)-(bi&&bi.clientTop||bf&&bf.clientTop||0)}}}if(bj.x!==bg.x||bj.y!==bg.y){bj.x=bg.x||bj.x;bj.y=bg.y||bj.y;bj.deltaX=bj.x-bj.lx;bj.deltaY=bj.y-bj.ly;bj.lx=bj.x;bj.ly=bj.y;bj.angle=bh.angle||0;bj.direction=bh.direction||"none"}}return bj}function e(bf){S.pointerInGame=false;S.signals.onGamePointerLeft.dispatch(bf)}function ai(bf){S.pointerInGame=true;S.signals.onGamePointerEntered.dispatch(bf)}function B(bf){if(S.pointerInGame===true){S.signals.onGamePointerMoved.dispatch(bf);I(bf)}}function aC(bf){S.signals.onGamePointerTapped.dispatch(bf,T(bf));I(bf)}function al(bf){S.signals.onGamePointerDoubleTapped.dispatch(bf,T(bf));I(bf)}function g(bf){S.signals.onGamePointerHeld.dispatch(bf,T(bf));I(bf)}function j(bf){S.signals.onGamePointerDragStarted.dispatch(bf,r.get_pointer(bf));I(bf)}function K(bf){S.signals.onGamePointerDragged.dispatch(bf,r.get_pointer(bf));I(bf)}function X(bf){S.signals.onGamePointerDragEnded.dispatch(bf,r.get_pointer(bf));I(bf)}function ay(bg){var bf=bg.originalEvent||bg;bg.wheelDelta=bf.wheelDelta=((bf.detail<0||bf.wheelDelta>0)?1:-1)*S.pointerWheelSpeed;S.signals.onGamePointerWheel.dispatch(bg);I(bg);bg.preventDefault()}function aB(bf){bf.preventDefault()}function ag(bf){S.signals.onKeyPressed.dispatch(bf);I(bf)}function ab(bf){S.signals.onKeyReleased.dispatch(bf);I(bf)}function I(bj){var bi,bg,bh,bf;if(typeof bj==="undefined"||bj.metaKey||bj.ctrlKey||bj.shiftKey||bj.altKey){return}bf=(bj.type+"");if(bf==="tap"||bf==="doubletap"||bf==="hold"||bf==="dragstart"||bf==="drag"||bf==="dragend"||bf==="mousemove"){bg="pointer";bh=bf}else{if(bf==="mousewheel"||bf==="DOMMouseScroll"){bg="pointer";bh="wheel"}else{bi=((bj.which||bj.key||bj.keyCode)+"").toLowerCase();bg=V.key(bi);bh=bf.toLowerCase();bh=bh.replace("key","")}}S.signals.onGameInput.dispatch(bj,bg,bh)}function k(bf){S.focused=false;S.signals.onFocusLost.dispatch(bf)}function aY(bf){S.focused=true;S.signals.onFocusGained.dispatch(bf)}function af(bh){var bf,bg;S.screenWidth=$(window).width();S.screenHeight=$(window).height();S.screenViewableWidth=S.domElements.$game.width();S.screenViewableHeight=S.domElements.$game.height();if(aZ){aZ.resize()}if(aI===true){S.signals.onWindowResized.dispatch(S.screenWidth,S.screenHeight);bf=S.gameWidth=S.screenViewableWidth;bg=S.gameHeight=S.screenViewableHeight;$(S.renderer.domElement).css({top:S.screenOffsetTop,bottom:S.screenOffsetBottom,left:S.screenOffsetLeft,right:S.screenOffsetRight});S.renderer.setSize(bf,bg);S.renderTarget.width=bf;S.renderTarget.height=bg;S.cameraBG.aspect=S.camera.aspect=bf/bg;S.camera.updateProjectionMatrix();S.cameraBG.updateProjectionMatrix();a5.reset(S.renderTarget);Y()}}function aQ(bh,bg,bf){S.signals.onError.dispatch(bh,bg||"Unknown Origin",bf||"N/A")}function aH(bf){return bf instanceof $?bf.get(0):bf}function z(bf,bg){if(S.supports.pointerEvents){if(bg===true){bf.addClass("ignore-pointer-temporary")}else{bf.removeClass("ignore-pointer-temporary")}}else{if(bg===true){bf.on("tap.pointer doubletap.pointer hold.pointer dragstart.pointer drag.pointer, dragend.pointer",function(bh){bh.preventDefault();bh.stopPropagation();bf.stop(true).addClass("invisible");$(document.elementFromPoint(bh.clientX,bh.clientY)).trigger(bh);bf.stop(true).removeClass("invisible");return false})}else{bf.off(".pointer")}}}function aa(bi,bj,bg,bh){var bf=function(){if(typeof bj==="function"){bj.call(bg,bh)}};if(b(bh)!==true){bh=new Image()}bh.crossOrigin="";bh.src=bi;if(bh.complete){bf()}else{bh.onload=bf}return bh}function aW(bi){var bh,bj,bf,bl,bk,bg;bi=bi||{};bh=$(bi.element);bj=a1(bi.duration)?bi.duration:S.domFadeDuration;bf=a1(bi.opacity)?bi.opacity:0;bl=typeof bi.easing==="string"?bi.easing:S.domFadeEasing;bk=bi.callback;bh.each(function(){var bm=$(this),bo,bn,bq,br,bp,bs=function(){bm.removeClass("hiding");if(bf===0){bm.addClass(bp?"invisible":"hidden").css("opacity","").trigger("hidden");z(bo,false)}else{bm.trigger("shown");if(bf===1){bm.css("opacity","")}}if(typeof bk==="function"){bk()}};br=bm.is(".invisible");bq=bm.is(".hiding, .hidden")||br;bn=bm.is(".collapsed");bp=br||bi.invisible;bm.stop(true).removeClass("invisible hiding hidden collapsed");bo=bm.find("a, button").add(bm);if(bq===true||bn===true||bi.initHidden===true){bm.fadeTo(0,0).css("height","")}if(bf===0){bm.addClass("hiding").trigger("hide");z(bo,true)}else{z(bo,false);bm.trigger("show")}bm.animate({opacity:bf},{duration:bj,easing:bl,complete:bs})})}function aw(bh){var bg,bi,bf,bk,bj;bh=bh||{};bg=$(bh.element);bf=typeof bh.show==="boolean"?bh.show:false;bi=a1(bh.duration)?bh.duration:S.domCollapseDuration;bk=typeof bh.easing==="string"?bh.easing:S.domCollapseEasing;bj=bh.callback;bg.each(function(){var bt=$(this),bm,bo,bl,bs,br,bq,bn=0,bp=function(){if(bf===true){bt.css("height","").trigger("shown")}else{bt.addClass(br?"invisible":"hidden").trigger("hidden");z(bm,false)}if(typeof bj==="function"){bj()}};bs=bt.is(".invisible");bl=bt.is(".hiding, .hidden")||bs;bo=bt.is(".collapsed");br=bs||bh.invisible;if(bo!==true&&(bl===true||bh.initHidden===true)){bt.css("height",0).css("opacity","");bo=true}if(bo===bf){bt.stop(true).removeClass("invisible hiding hidden collapsed");bm=bt.find("a, button").add(bt);if(bf===true){bt.placeholdme().appendTo("body");bq=bt.height();bt.css("height","");bn=bt.height();bt.css("height",bq);bt.placeholdme("revert");z(bm,false);bt.trigger("show")}else{z(bm,true);bt.addClass("collapsed").trigger("hide")}bt.animate({height:bn},{duration:bi,easing:bk,complete:bp})}})}function a0(){F.tasksStarted=[];F.tasksCompleted=[];S.signals.onWorkerReset.dispatch()}function q(bf){if(typeof bf==="string"&&bf.length>0&&F.tasksStarted.hasOwnProperty(bf)!==true){F.taskCount++;F.tasksStarted.push(bf);S.signals.onWorkerTaskStarted.dispatch(bf)}}function aP(bg){var bf=W(F.tasksStarted,bg);if(bf!==-1){F.tasksStarted.splice(bf,1);F.tasksCompleted.push(bg);S.signals.onWorkerTaskCompleted.dispatch(bg);if(F.tasksStarted.length===0){S.signals.onWorkerTasksCompleted.dispatch()}}}function i(bj,bg,bo,bm){var bk,bh,bn,bq,bf,bl,bp=true,bi;if(typeof bj!=="undefined"){if(typeof bj==="string"||bj.hasOwnProperty("length")===false){bj=[bj]}bj=bj.slice(0);if(typeof bo!=="string"||O.listLocations.hasOwnProperty(bo)){bo=O.listCount}O.listCount++;for(bk=0,bh=bj.length;bk<bh;bk++){bn=bj[bk];bq=N(bn);bf=W(O.loading,bq);bl=W(O.loaded,bq);if(bf===-1&&bl==-1){O.loading.push(bq);O.loadingListIDs.push(bo);q(bq);newLocations=true}if(bl===-1){bp=false}}O.loadingOrLoaded=O.loaded.concat(O.loading);O.listLocations[bo]=bj;if(typeof bg==="undefined"){bg=[]}else{if(typeof bg==="function"||bg.hasOwnProperty("length")===false){bg=[bg]}}O.listCallbacks[bo]=bg;if(typeof bm!=="string"){bm=O.tips[Math.max(0,Math.min(O.tips.length-1,Math.round(Math.random()*O.tips.length)-1))]}O.listMessages[bo]=bm;O.listLoaded[bo]=[];O.lists.push(bo);if(bp===true){aV(bo)}else{U()}}}function U(){var bh,bg,bj,bf,bi;if(O.active===false&&O.lists.length>0){O.active=true;O.listCurrent=O.lists[0];bj=O.listLocations[O.listCurrent].slice(0);for(bh=0,bg=bj.length;bh<bg;bh+=1){bf=bj[bh];bi=N(bf);if(W(O.loaded,bi)!==-1){l(bf)}else{if(W(O.started,bi)===-1){O.started.push(bi);G(bf)}}}}else{O.listCurrent=undefined;S.signals.onLoadAllCompleted.dispatch()}}function G(bf){var bj,bh,bk,bi,bl=function(bm){if(typeof bm!=="undefined"){bi=bm}l(bf,bi)},bg=function(bm){l(bf,bm)};if(typeof bf!=="undefined"){bk=bf.type||O.loadTypeBase;bj=N(bf);bh=aO(bj);if(bh===""){bj=v(bj)}if(bk==="image"||a2(bh)){bi=aa(bj,bl);ad(bj,{data:bi})}else{if(bk==="model"){if(typeof O.threeJSON==="undefined"){O.threeJSON=new THREE.JSONLoader(true)}O.threeJSON.load(bj,bg)}else{if(bk==="json"){$.getJSON(bj,bl)}else{$LAB.script(bj).wait(bl)}}}}}function l(bn,bh){var bi,bf,bo,bg,bk,bl,bp,bm,bj;bp=N(bn);bm=o(bn);aP(bp);ad(bp,{data:bh});M(bp);if(typeof S!=="undefined"){S.signals.onLoadItemCompleted.dispatch(bp)}for(bi=0,bf=O.lists.length;bi<bf;bi++){bo=O.lists[bi];bg=O.listLocations[bo];bl=W(bg,bn);if(bl!==-1){bk=O.listLoaded[bo];bg.splice(bl,bl!==-1?1:0);bk.push(bn);if(bg.length===0){bj=bj||[];bj.push(bo)}}}if(typeof bj!=="undefined"){for(bi=0,bf=bj.length;bi<bf;bi++){aV(bj[bi])}}}function aV(bh){var bi,bg,bf,bk,bj;bj=W(O.lists,bh);if(bj!==-1){O.lists.splice(bj,1)}bf=O.listCallbacks[bh];for(bi=0,bg=bf.length;bi<bg;bi++){bk=bf[bi];if(typeof bk!=="undefined"){bk.call(this)}}if(typeof S!=="undefined"){S.signals.onLoadListCompleted.dispatch(bh)}delete O.listLocations[bh];delete O.listCallbacks[bh];delete O.listMessages[bh];delete O.listLoaded[bh];O.active=false;U()}function M(bm){var bj,bg,bf,bl,bh,bi,bk=false;bm=a4(bm);for(bj=0,bg=bm.length;bj<bg;bj++){bf=bm[bj];bl=N(bf);bi=W(O.loading,bl);if(bi!==-1){O.loadingListIDs.splice(bi,1);O.loading.splice(bi,1)}bh=W(O.loaded,bl);if(bh===-1){O.loaded.push(bl);bk=true}}if(bk===true){O.loadingOrLoaded=O.loaded.concat(O.loading)}}function aD(bf,bh){var bi,bg;bi=N(bf);bg=W(bh,bi);if(bg!==-1){return true}else{return false}}function aJ(bf){return aD(bf,O.loadingOrLoaded)}function p(bf){return aD(bf,O.loaded)}function w(bf){return aD(bf,O.loading)}function o(bf){return bf.type||O.loadTypeBase}function N(bf){return bf.path||bf}function aO(bf){var bi,bh,bg="";bi=N(bf);bh=bi.lastIndexOf(".");if(bh!==-1){bg=bi.substr(bh+1).toLowerCase()}return bg}function v(bf){var bg=E(bf);bg=bg.replace(/\./g,"")+".js";return bg}function E(bf){var bh,bg;bh=N(bf);bg=bh.lastIndexOf(".");if(bg!==-1){bh=bh.substr(0,bg)}return bh}function a(bf){var bh,bg;bh=N(bf);bg=aO(bh);if(bg===""){return v(bh)}else{return E(bh)}}function n(bk){var bi,bf,bg,bh,bj;bg=bk.split(/[\\\/]/);for(bi=0,bf=bg.length;bi<bf;bi++){bh=bg[bi];bh=bh.replace(/[^\w\.\-]+/g,"");if(bh===""){aQ("Invalid asset cascade","Main","N/A");return}bg[bi]=bh}return bg}function au(bk,bl){var bn,bi,bj,bm,bg,bh,bf;bg=bj=r;bn=N(bk);bi=n(bn);for(bh=0,bf=bi.length;bh<bf;bh++){bj=bg;bm=bi[bh];bg=bj[bm];if(typeof bg==="undefined"){break}}bl=bl||1;if(typeof bg==="undefined"){if(bl===1){return au(a(bn),bl+1)}}return bg}function C(bn,bl){var bp,bk,bm,bo,bh,bj,bf,bi,bg;if(bl instanceof bc){bh=bm=r;bp=N(bn);bk=n(bp);for(bi=0,bg=bk.length;bi<bg;bi++){bm=bh;bo=bk[bi];bh=bm[bo]=bm[bo]||{}}if(bh instanceof bc&&bh.is_empty()===false){if(bl.is_empty()===false){bh.merge_asset_self(bl)}}else{bm[bo]=bh=bl}}return bh}function d(bf){var bg,bh;bg=au(bf);bh=(bg instanceof bc)?bg.data:bg;return bh}function ad(bh,bg){var bf,bj,bi=au(bh);if(bi instanceof bc!==true||(bg&&typeof bg.data!=="undefined"&&bg.data!==bi.data)){bf=new bc(bh,bg);bj=bf.data}else{bj=bi.data}return bj}function ae(bi,bh){var bg,bf;bh=bh||au(bi);if(bh instanceof bc){bh.ready=true;bh.wait=false;if(typeof S.signals!=="undefined"&&typeof S.signals.onAssetReady!=="undefined"){S.signals.onAssetReady.dispatch(bi)}}}function a7(bl,bk,bp,bo){var bh,bj,bn,bi=[],bg=[],bf=[],bm=false;bl=a4(bl);bk=a4(bk);bj=function(bs,br){var bq;bq=W(bg,bs);if(bq!==-1){bg.splice(bq,1);bf.push(bs);if(bg.length===0&&bf.length===bl.length){if(bm===true){S.signals.onAssetReady.remove(bj);bm=false}bn()}}else{if(br!==true){bj(a(bs),true)}}};bn=function(){var br,bq,bs;for(br=0,bq=bk.length;br<bq;br++){bs=bk[br];bs.apply(this,bi)}if(bo instanceof bc&&bo.readyAutoUpdate===true){bo.on_ready()}};bh=function(){var bs,br,bq,bu,bt;for(bs=0,br=bl.length;bs<br;bs++){bq=bl[bs];bu=N(bq);bt=au(bq);if(bt instanceof bc){bi.push(bt.data)}if(bp===true){bg.push(bu);if(bt instanceof bc&&bt.ready===true){bj(bu)}else{if(bm===false){bm=true;S.signals.onAssetReady.add(bj)}}}}if(bp!==true||bl.length===0){bn()}};i(bl,bh)}function bc(bh,bg){var bf=this;bg=bg||{};bg.path=bh;bf.merge_asset_self(bg,true);if(typeof bf.path!=="undefined"){bf=C(bf.path,bf);if(bf===this&&this.readyAutoUpdate===true&&(this.requirements.length===0||this.wait!==true)){this.on_ready()}if(this.requirements.length>0){a7(this.requirements,this.callbacksOnReqs,this.wait,this)}}return bf}bc.prototype={};bc.prototype={constructor:bc,merge_asset_self:function(bg,bf){var bh;if(typeof bg!=="undefined"){this.path=bg.path;this.merge_asset_data_self(bg);if(typeof this.wait!=="boolean"||this.wait===false){if(bg.wait===true){this.wait=bg.wait}else{this.wait=false}}if(this.ready!==true){this.ready=false}if(typeof this.readyAutoUpdate!=="boolean"){if(bg.hasOwnProperty("readyAutoUpdate")){this.readyAutoUpdate=bg.readyAutoUpdate}else{this.readyAutoUpdate=true}}this.requirements=a4(this.requirements);this.callbacksOnReqs=a4(this.callbacksOnReqs);if(bf===true){this.requirements=this.requirements.concat(a4(bg.requirements));this.callbacksOnReqs=this.callbacksOnReqs.concat(a4(bg.callbacksOnReqs))}}},merge_asset_data_self:function(bg){var bf=bg.data;if(typeof bf!=="undefined"){if(typeof this.data==="undefined"||b(bf)){this.data=bf}else{aq(bf,this.data)}}},is_empty:function(){var bf=true;if(typeof this.data!=="undefined"||(this.ready===false&&this.requirements.length>0)){bf=false}return bf},on_ready:function(){ae(this.path,this)}};return r}(KAIOPUA||{}));