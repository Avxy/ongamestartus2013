var KAIOPUA=(function(r){window.console=window.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};var S=r.shared=r.shared||{};S.domElements={};S.supports={webGL:true};S.throttled={};S.spawns={};S.pointers=[];S.originLink=window.location.pathname.toString();S.pathToIcons="img/";S.pathToAssets="asset/";S.frameRateMax=60;S.frameRateMin=20;S.time=new Date().getTime();S.timeLast=S.time;S.timeDeltaExpected=1000/60;S.timeDeltaModDec=Math.pow(10,2);S.pointerWheelSpeed=120;S.pointerHoldPositionShift=10;S.pointerInGame=true;S.throttleTimeShort=S.timeDeltaExpected*3;S.throttleTimeMedium=100;S.throttleTimeLong=250;S.throttleTimeLong=250;S.focused=true;S.errorString="error";S.errorTypeGeneral="General";S.errorTypeWebGLBrowser="WebGLBrowser";S.errorTypeWebGLComputer="WebGLComputer";S.errorTypes=[S.errorTypeGeneral,"WebGLBrowser","WebGLComputer"];S.errorTypesOnlyOnce=["WebGLBrowser","WebGLComputer"];S.webGLNames=["webgl","experimental-webgl","webkit-3d","moz-webgl"];S.fadeBetweenSections=false;S.domFadeDuration=500;S.domCollapseDuration=500;S.domFadeEasing="easeInOutCubic";S.domCollapseEasing="easeInOutCubic";S.screenWidth=0;S.screenHeight=0;S.screenViewableWidth=0;S.screenViewableHeight=0;S.screenOffsetTop=0;S.screenOffsetBottom=0;S.screenOffsetLeft=0;S.screenOffsetRight=0;var O={},F={},s,al,V,a2,y,ay,a8,ak,aK=false,aO=false,A=false,aw=false,aI=false,aN=false,bb=500,aG=["js/lib/RequestAnimationFrame.js","js/lib/RequestInterval.js","js/lib/RequestTimeout.js","js/lib/signals.min.js","js/lib/jquery-1.8.3.min.js"],bc=["js/lib/hammer.custom.js","js/lib/bootstrap.min.js","js/lib/jquery.easing-1.3.min.js","js/lib/jquery.throttle-debounce.custom.min.js","js/lib/jquery.placeholdme.js"],aX=["js/kaiopua/ui/UI.js","js/kaiopua/utils/KeyHelper.js"],aq=["js/lib/three/three.min.js","js/lib/Tween.custom.min.js"],R=["js/lib/three/ThreeOctree.min.js","js/lib/three/postprocessing/ShaderExtras.js","js/lib/three/postprocessing/EffectComposer.js","js/lib/three/postprocessing/RenderPass.js","js/lib/three/postprocessing/MaskPass.js","js/lib/three/postprocessing/ShaderPass.js"],h=["js/kaiopua/core/Scene.js","js/kaiopua/core/CameraControls.js"],ao=["js/kaiopua/sections/Launcher.js"],P=["js/kaiopua/sections/Start.js"];$LAB.script(aG).wait().script(bc).wait(au);function au(){S.domElements.$game=$("#game");S.supports.pointerEvents=aC("pointer-events");S.signals={onError:new signals.Signal(),onFocusLost:new signals.Signal(),onFocusGained:new signals.Signal(),onKeyPressed:new signals.Signal(),onKeyReleased:new signals.Signal(),onGameInput:new signals.Signal(),onWindowResized:new signals.Signal(),onUpdated:new signals.Signal(),onWorkerReset:new signals.Signal(),onWorkerTaskStarted:new signals.Signal(),onWorkerTaskCompleted:new signals.Signal(),onWorkerTasksCompleted:new signals.Signal(),onLoadItemCompleted:new signals.Signal(),onLoadListCompleted:new signals.Signal(),onLoadAllCompleted:new signals.Signal(),onAssetReady:new signals.Signal(),onGameStateChange:new signals.Signal(),onGamePlayable:new signals.Signal(),onGameReady:new signals.Signal(),onGamePaused:new signals.Signal(),onGameResumed:new signals.Signal(),onGameUpdated:new signals.Signal(),onGameStarted:new signals.Signal(),onGameStartedCompleted:new signals.Signal(),onGameStopped:new signals.Signal(),onGameStoppedCompleted:new signals.Signal(),onGamePointerLeft:new signals.Signal(),onGamePointerEntered:new signals.Signal(),onGamePointerMoved:new signals.Signal(),onGamePointerTapped:new signals.Signal(),onGamePointerDoubleTapped:new signals.Signal(),onGamePointerHeld:new signals.Signal(),onGamePointerDragStarted:new signals.Signal(),onGamePointerDragged:new signals.Signal(),onGamePointerDragEnded:new signals.Signal(),onGamePointerWheel:new signals.Signal()};$(document).on("keydown",ah).on("keyup",ac);S.throttled.reposition_pointer=$.throttle(S.throttleTimeShort,T);S.throttled.on_window_resized=$.throttle(S.throttleTimeLong,ag);$(window).on("mousemove",S.throttled.reposition_pointer).on("blur",k).on("focus",a1).on("resize",S.throttled.on_window_resized);window.onerror=aS;S.signals.onFocusLost.add(function(){if(aI!==true){aN=true}ai(true)});S.signals.onFocusGained.add(function(){if(aN===true){aN=false;a6(true)}});O.active=false;O.listCount=0;O.lists=[];O.listLocations={};O.listLoaded={};O.listMessages={};O.listCallbacks={};O.loading=[];O.loadingListIDs=[];O.started=[];O.loaded=[];O.loadingOrLoaded=[];O.listCurrent="";O.loadTypeBase="script";O.tips=[];M(aG);M(bc);F.taskCount=0;F.tasksStarted=[];F.tasksCompleted=[];a3();r.type=ad;r.is_number=a4;r.is_array=bh;r.is_image=b;r.is_image_ext=a5;r.is_event=aB;r.extend=ar;r.time_test=L;r.to_array=a7;r.ensure_not_array=c;r.array_cautious_add=m;r.array_cautious_remove=aP;r.array_random_value=an;r.array_random_value_remove=aV;r.index_of_value=X;r.last_index_of_value=aA;r.indices_of_value=t;r.index_of_values=x;r.index_of_property=aU;r.indices_of_property=at;r.index_of_properties=f;r.css_property_supported=aC;r.str_to_camel=aT;r.str_to_title=W;r.dom_extract=aJ;r.dom_generate_image=ab;r.dom_ignore_pointer=z;r.dom_fade=aZ;r.dom_collapse=ax;r.get_pointer=ap;r.reposition_pointer=T;r.worker_reset=a3;r.worker_task_start=q;r.worker_task_complete=aR;r.load=i;r.get_is_loaded=p;r.get_is_loading=w;r.get_is_loading_or_loaded=aL;r.get_asset_path=N;r.get_ext=aQ;r.add_default_ext=v;r.remove_ext=E;r.get_alt_path=a;r.asset_register=ae;r.asset_require=ba;r.asset_ready=af;r.set_asset=C;r.get_asset=av;r.get_asset_data=d;r.set_section=H;r.start=u;r.stop=aM;r.resume=a6;r.pause=ai;Object.defineProperty(r,"paused",{get:function(){return aI}});Object.defineProperty(r,"started",{get:function(){return aw}});Object.defineProperty(r,"setup",{get:function(){return aK}});Object.defineProperty(r,"playable",{get:function(){return aO}});Object.defineProperty(r,"ready",{get:function(){return A},set:function(bi){if(A!==bi){A=bi;S.signals.onGameReady.dispatch(A);S.signals.onGameStateChange.dispatch(A)}}});Object.defineProperty(r,"focusLost",{get:function(){return aN}});$(window).ready(function(){$(window).trigger("resize");Q();ba(aX,bg,true)})}function bg(bo,bp){console.log("GAME: compatiblity check");var bl,bi,bj,bk,bn;a2=bo;V=bp;try{if(!window.WebGLRenderingContext){bn=S.errorTypeWebGLBrowser}else{bj=document.createElement("canvas");for(bl=0,bi=S.webGLNames.length;bl<bi;bl+=1){bk=bj.getContext(S.webGLNames[bl]);if(bk){break}}if(!bk){bn=S.errorTypeWebGLComputer}}}catch(bm){bn=S.errorTypeWebGLBrowser}S.errorCurrent=bn;if(typeof S.errorCurrent!=="undefined"){S.supports.webGL=false;S.signals.onGameStateChange.dispatch();aS(S.errorCurrent)}else{D()}}function D(){r.asset_require(aq,[aa],true)}function aa(){r.asset_require(R,[J,aH],true)}function aH(){r.asset_require(h,[a9,be],true)}function be(){r.asset_require(ao,[bd,a0],true)}function a0(){r.asset_require(P,aW,true)}function J(){console.log("GAME: foundation");S.universeGravitySource=new THREE.Vector3(0,0,0);S.universeGravityMagnitude=new THREE.Vector3(0,-0.4,0);S.cardinalAxes={up:new THREE.Vector3(0,1,0),forward:new THREE.Vector3(0,0,1),right:new THREE.Vector3(-1,0,0)};S.renderer=new THREE.WebGLRenderer({clearColor:0,clearAlpha:0,maxLights:8});S.renderer.setSize(S.gameWidth,S.gameHeight);S.renderer.autoClear=false;S.renderTarget=new THREE.WebGLRenderTarget(S.gameWidth,S.gameHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter})}function a9(bi,bj){console.log("GAME: setup");s=bi;al=bj;S.scene=new s.Instance();S.sceneBG=new s.Instance();S.scene.fog=undefined;r.physics=S.scene.physics;S.camera=new THREE.PerspectiveCamera(60,S.gameWidth/S.gameHeight,1,20000);S.cameraBG=new THREE.PerspectiveCamera(60,S.gameWidth/S.gameHeight,1,20000);S.camera.useQuaternion=S.cameraBG.useQuaternion=true;S.cameraControls=new al.Instance({camera:S.camera});S.cameraControls.onCameraMoved.add($.throttle(S.throttleTimeMedium,function(){S.domElements.$game.triggerHandler("mousemove")}));ak={bg:new THREE.RenderPass(S.sceneBG,S.cameraBG),env:new THREE.RenderPass(S.scene,S.camera),screen:new THREE.ShaderPass(THREE.ShaderExtras.screen)};ak.env.clear=false;ak.screen.renderToScreen=true;a8=new THREE.EffectComposer(S.renderer,S.renderTarget);a8.addPass(ak.bg);a8.addPass(ak.env);a8.addPass(ak.screen);S.domElements.$game.prepend(S.renderer.domElement);S.throttled.on_game_pointer_moved=$.throttle(S.throttleTimeShort,B);S.throttled.on_game_pointer_dragged=$.throttle(S.throttleTimeShort,true,K);S.domElements.$game.on("mouseleave",e).on("mouseenter",aj).on("mousemove",S.throttled.on_game_pointer_moved).on("tap",aE).on("doubletap",am).on("hold",g).on("dragstart",j).on("drag",S.throttled.on_game_pointer_dragged).on("dragend",Y).on("mousewheel DOMMouseScroll",az).on("contextmenu",aD);aK=true;ag()}function bd(bi){y=bi;H(y)}function aW(bi){console.log("GAME: playable");ay=bi;aO=true;S.signals.onGamePlayable.dispatch();S.signals.onGameStateChange.dispatch()}function H(bk,bm){var bl=S.fadeBetweenSections,bj=false,bi=function(){if(typeof S.sectionLast!=="undefined"){S.sectionLast.remove()}bk.show();S.section=bk;if(bl!==false){r.dom_fade({element:S.domElements.$uiBlocker})}a6();if(typeof bm!=="undefined"){bm.call()}};ai(true);if(typeof S.section!=="undefined"){bj=true;S.sectionLast=S.section;S.sectionLast.hide();if(bl!==false){r.dom_fade({element:S.domElements.$uiBlocker,opacity:1})}}S.section=undefined;if(typeof startedValue!=="undefined"){aw=startedValue}if(typeof bk!=="undefined"){if(bl!==false&&bj===true){window.requestTimeout(function(){bi()},bb)}else{bi()}}}function u(){if(aO===true){if(aw===false){console.log("GAME: START");aw=true;S.signals.onGameStarted.dispatch();H(ay,function(){S.signals.onGameStartedCompleted.dispatch()})}else{a6()}}}function aM(){if(aO===true){console.log("GAME: STOP");aw=false;S.signals.onGameStopped.dispatch();H(y,function(){S.signals.onGameStoppedCompleted.dispatch()})}}function ai(bi,bj){if(aI===false){console.log("GAME: PAUSE");aI=true;S.signals.onGamePaused.dispatch(bi,bj);Z()}}function a6(bi){if(aI===true&&(typeof S.errorCurrent==="undefined"||aw!==true)){console.log("GAME: RESUME");aI=false;S.signals.onGameResumed.dispatch(bi)}}function Q(){var bi,bj;window.requestAnimationFrame(Q);S.timeLast=S.time;S.time=new Date().getTime();bi=S.time-S.timeLast;bj=Math.round((bi/S.timeDeltaExpected)*S.timeDeltaModDec)/S.timeDeltaModDec;if(a4(bj)!==true){bj=1}S.signals.onUpdated.dispatch(bi,bj);if(aI!==true&&aK===true){TWEEN.update();if(r.physics){r.physics.update(bi,bj)}S.signals.onGameUpdated.dispatch(bi,bj);Z()}}function Z(){if(aK===true){S.cameraControls.update();S.cameraBG.quaternion.copy(S.camera.quaternion);S.renderer.setViewport(0,0,S.gameWidth,S.gameHeight);S.renderer.clear();a8.render()}}function ad(bi){return bi===null?bi+"":Object.prototype.toString.call(bi).slice(8,-1).toLowerCase()}function bh(bi){return Object.prototype.toString.call(bi)==="[object Array]"}function a4(bi){return !isNaN(bi)&&isFinite(bi)&&typeof bi!=="boolean"}function b(bi){return(typeof bi!=="undefined"&&bi.hasOwnProperty("nodeName")&&bi.nodeName.toLowerCase()==="img")}function a5(bi){if(bi==="jpg"||bi==="jpeg"||bi==="png"||bi==="gif"||bi==="bmp"){return true}else{return false}}function aB(bi){return bi&&(bi.type&&(bi.target||bi.srcElement))}function ar(bi,bw,by,bq){var bt,br,bo,bl,bk,bx,bs,bu,bp,bn,bm,bj,bv;if(typeof bi!=="undefined"){bw=r.type(bw)==="object"?bw:{};bo=Object.getOwnPropertyNames(bi);for(bt=0,br=bo.length;bt<br;bt++){bl=bo[bt];bk=Object.getOwnPropertyDescriptor(bi,bl);if(bw.hasOwnProperty(bl)){delete bw[bl]}Object.defineProperty(bw,bl,bk);if(by===true){bk=Object.getOwnPropertyDescriptor(bw,bl);bx=bk.value;bs=ad(bx);if(bs==="object"||bs==="array"){bq=bq||{sources:[],copies:[]};bu=bq.sources;bp=bq.copies;bn=X(bu,bx);if(bn===-1){bj=bu[bu.length]=bx;bv=bp[bp.length]=(bs==="object"?{}:[]);if(bx===bi){bx[bl]=bv}bk.value=ar(bx,bv,true,bq)}else{bk.value=bp[bn]}Object.defineProperty(bw,bl,bk)}}}}return bw}function L(bm,bo,bn){var bl,bk,bj,bi;bo=a4(bo)&&bo>0?bo:1;bn=typeof bn==="string"?bn:"";bk=new Date().getTime();for(bl=0;bl<bo;bl++){bi=bm.call()}bj=new Date().getTime();console.log(bn," > time test ( x",bo,"): ",(bj-bk));return bi}function a7(bi){return bi?(bh(bi)!==true?[bi]:bi):[]}function c(bj,bi){return bh(bj)===true?bj[bi||0]:bj}function m(bo,bn){var bl,bi,bk,bj,bm=false;bo=a7(bo);bn=a7(bn);for(bl=0,bi=bn.length;bl<bi;bl++){bk=bn[bl];bj=X(bo,bk);if(bj===-1){bo.push(bk);bm=true}}return bm}function aP(bo,bm){var bl,bi,bk,bj,bn=false;bo=a7(bo);bm=a7(bm);for(bl=0,bi=bm.length;bl<bi;bl++){bk=bm[bl];bj=X(bo,bk);if(bj!==-1){bo.splice(bj,1);bn=true}}return bn}function an(bi){return bi[Math.round(Math.random()*(bi.length-1))]}function aV(bi){return bi.splice(Math.round(Math.random()*(bi.length-1)),1)[0]}function X(bl,bk){for(var bj=0,bi=bl.length;bj<bi;bj++){if(bk===bl[bj]){return bj}}return -1}function aA(bk,bj){for(var bi=bk.length-1;bi>=0;bi--){if(bj===bk[bi]){return bi}}return -1}function t(bm,bk){var bl=[];for(var bj=0,bi=bm.length;bj<bi;bj++){if(bk===bm[bj]){bl.push(bj)}}return bl}function x(bl,bj){for(var bk=0,bi=bl.length;bk<bi;bk++){if(X(bj,bl[bk])!==-1){return bk}}return -1}function aU(bm,bl,bk){for(var bj=0,bi=bm.length;bj<bi;bj++){if(bk===bm[bj][bl]){return bj}}return -1}function at(bn,bl,bk){var bm=[];for(var bj=0,bi=bn.length;bj<bi;bj++){if(bk===bn[bj][bl]){bm.push(bj)}}return bm}function f(bo,bn,bj){for(var bm=0,bi=bo.length;bm<bi;bm++){for(var bk=0,bl=bn.length;bk<bl;bk++){if(bj[bk]===bo[bm][bn[bk]]){return bm}}}return -1}function ap(bi){bi=bi||{};var bk=bi.identifier=(bi.identifier?bi.identifier:0),bj=S.pointers[bk];if(typeof bj==="undefined"){bj=S.pointers[bk]={};bj.id=bk;bj.x=bj.lx=S.screenWidth*0.5;bj.y=bj.ly=S.screenHeight*0.5;bj.deltaX=bj.deltaY=bj.angle=bj.distance=bj.distanceX=bj.distanceY=0;bj.direction="none"}return bj}function T(bk){S.timeSinceInteraction=0;var bm=r.get_pointer(bk),bj,bl,bi;if(bk){bj=bk.position;if(bh(bj)&&bj[bm.id]){bj=bj[bm.id]}if(typeof bj==="undefined"){bl=document;bi=bl.body;bj={x:bm.x,y:bm.y};if(typeof bk.pageX!=="undefined"){bj.x=bk.pageX}else{if(typeof bk.clientX!=="undefined"){bj.x=bk.clientX+(bl&&bl.scrollLeft||bi&&bi.scrollLeft||0)-(bl&&bl.clientLeft||bi&&bi.clientLeft||0)}}if(typeof bk.pageY!=="undefined"){bj.y=bk.pageY}else{if(typeof bk.clientY!=="undefined"){bj.y=bk.clientY+(bl&&bl.scrollTop||bi&&bi.scrollTop||0)-(bl&&bl.clientTop||bi&&bi.clientTop||0)}}}if(bm.x!==bj.x||bm.y!==bj.y){bm.x=bj.x||bm.x;bm.y=bj.y||bm.y;bm.deltaX=bm.x-bm.lx;bm.deltaY=bm.y-bm.ly;bm.lx=bm.x;bm.ly=bm.y;bm.angle=bk.angle||0;bm.direction=bk.direction||"none"}}return bm}function e(bi){S.pointerInGame=false;S.signals.onGamePointerLeft.dispatch(bi)}function aj(bi){S.pointerInGame=true;S.signals.onGamePointerEntered.dispatch(bi)}function B(bi){if(S.pointerInGame===true){S.signals.onGamePointerMoved.dispatch(bi);I(bi)}}function aE(bi){S.signals.onGamePointerTapped.dispatch(bi,T(bi));I(bi)}function am(bi){S.signals.onGamePointerDoubleTapped.dispatch(bi,T(bi));I(bi)}function g(bi){S.signals.onGamePointerHeld.dispatch(bi,T(bi));I(bi)}function j(bi){S.signals.onGamePointerDragStarted.dispatch(bi,r.get_pointer(bi));I(bi)}function K(bi){S.signals.onGamePointerDragged.dispatch(bi,r.get_pointer(bi));I(bi)}function Y(bi){S.signals.onGamePointerDragEnded.dispatch(bi,r.get_pointer(bi));I(bi)}function az(bj){var bi=bj.originalEvent||bj;bj.wheelDelta=bi.wheelDelta=((bi.detail<0||bi.wheelDelta>0)?1:-1)*S.pointerWheelSpeed;S.signals.onGamePointerWheel.dispatch(bj);I(bj);bj.preventDefault()}function aD(bi){bi.preventDefault()}function ah(bi){S.signals.onKeyPressed.dispatch(bi);I(bi)}function ac(bi){S.signals.onKeyReleased.dispatch(bi);I(bi)}function I(bm){var bl,bj,bk,bi;if(typeof bm==="undefined"||bm.metaKey||bm.ctrlKey||bm.shiftKey||bm.altKey){return}bi=(bm.type+"");if(bi==="tap"||bi==="doubletap"||bi==="hold"||bi==="dragstart"||bi==="drag"||bi==="dragend"||bi==="mousemove"){bj="pointer";bk=bi}else{if(bi==="mousewheel"||bi==="DOMMouseScroll"){bj="pointer";bk="wheel"}else{bl=((bm.which||bm.key||bm.keyCode)+"").toLowerCase();bj=V.key(bl);bk=bi.toLowerCase();bk=bk.replace("key","")}}S.signals.onGameInput.dispatch(bm,bj,bk)}function k(bi){S.focused=false;S.signals.onFocusLost.dispatch(bi)}function a1(bi){S.focused=true;S.signals.onFocusGained.dispatch(bi)}function ag(bk){var bi,bj;S.screenWidth=$(window).width();S.screenHeight=$(window).height();S.screenViewableWidth=S.domElements.$game.width();S.screenViewableHeight=S.domElements.$game.height();if(a2){a2.resize()}if(aK===true){S.signals.onWindowResized.dispatch(S.screenWidth,S.screenHeight);bi=S.gameWidth=S.screenViewableWidth;bj=S.gameHeight=S.screenViewableHeight;$(S.renderer.domElement).css({top:S.screenOffsetTop,bottom:S.screenOffsetBottom,left:S.screenOffsetLeft,right:S.screenOffsetRight});S.renderer.setSize(bi,bj);S.renderTarget.width=bi;S.renderTarget.height=bj;S.cameraBG.aspect=S.camera.aspect=bi/bj;S.camera.updateProjectionMatrix();S.cameraBG.updateProjectionMatrix();a8.reset(S.renderTarget);Z()}}function aS(bk,bj,bi){S.signals.onError.dispatch(bk,bj||"Unknown Origin",bi||"N/A")}function aC(bl){var bj,bi,bm,bk;bm=aT(bl);bk=Modernizr.prefixed(bm);return !!bk}function aT(bm){var bl=bm.split("-"),bi=bl.length,bk;if(bi==1){return bl[0]}bk=bm.charAt(0)=="-"?bl[0].charAt(0).toUpperCase()+bl[0].substring(1):bl[0];for(var bj=1;bj<bi;bj++){bk+=bl[bj].charAt(0).toUpperCase()+bl[bj].substring(1)}return bk}function W(bi){return bi.toLowerCase().replace(/\b[a-z]/g,function(bj){return bj.toUpperCase()})}function aJ(bi){return bi instanceof $?bi.get(0):bi}function z(bi,bj){if(S.supports.pointerEvents){if(bj===true){bi.addClass("ignore-pointer-temporary")}else{bi.removeClass("ignore-pointer-temporary")}}else{if(bj===true){bi.on("tap.pointer doubletap.pointer hold.pointer dragstart.pointer drag.pointer, dragend.pointer",function(bk){bk.preventDefault();bk.stopPropagation();bi.stop(true).addClass("invisible");$(document.elementFromPoint(bk.clientX,bk.clientY)).trigger(bk);bi.stop(true).removeClass("invisible");return false})}else{bi.off(".pointer")}}}function ab(bl,bm,bj,bk){var bi=function(){if(typeof bm==="function"){bm.call(bj,bk)}};if(b(bk)!==true){bk=new Image()}bk.crossOrigin="";bk.src=bl;if(bk.complete){bi()}else{bk.onload=bi}return bk}function aZ(bl){var bk,bm,bi,bo,bn,bj;bl=bl||{};bk=$(bl.element);bm=a4(bl.duration)?bl.duration:S.domFadeDuration;bi=a4(bl.opacity)?bl.opacity:0;bo=typeof bl.easing==="string"?bl.easing:S.domFadeEasing;bn=bl.callback;bk.each(function(){var bp=$(this),br,bq,bt,bu,bs,bv=function(){bp.removeClass("hiding");if(bi===0){bp.addClass(bs?"invisible":"hidden").css("opacity","").trigger("hidden");z(br,false)}else{bp.trigger("shown");if(bi===1){bp.css("opacity","")}}if(typeof bn==="function"){bn()}};bu=bp.is(".invisible");bt=bp.is(".hiding, .hidden")||bu;bq=bp.is(".collapsed");bs=bu||bl.invisible;bp.stop(true).removeClass("invisible hiding hidden collapsed");br=bp.find("a, button").add(bp);if(bt===true||bq===true||bl.initHidden===true){bp.fadeTo(0,0).css("height","")}if(bi===0){bp.addClass("hiding").trigger("hide");z(br,true)}else{z(br,false);bp.trigger("show")}bp.animate({opacity:bi},{duration:bm,easing:bo,complete:bv})})}function ax(bk){var bj,bl,bi,bn,bm;bk=bk||{};bj=$(bk.element);bi=typeof bk.show==="boolean"?bk.show:false;bl=a4(bk.duration)?bk.duration:S.domCollapseDuration;bn=typeof bk.easing==="string"?bk.easing:S.domCollapseEasing;bm=bk.callback;bj.each(function(){var bw=$(this),bp,br,bo,bv,bu,bt,bq=0,bs=function(){if(bi===true){bw.css("height","").trigger("shown")}else{bw.addClass(bu?"invisible":"hidden").trigger("hidden");z(bp,false)}if(typeof bm==="function"){bm()}};bv=bw.is(".invisible");bo=bw.is(".hiding, .hidden")||bv;br=bw.is(".collapsed");bu=bv||bk.invisible;if(br!==true&&(bo===true||bk.initHidden===true)){bw.css("height",0).css("opacity","");br=true}if(br===bi){bw.stop(true).removeClass("invisible hiding hidden collapsed");bp=bw.find("a, button").add(bw);if(bi===true){bw.placeholdme().appendTo("body");bt=bw.height();bw.css("height","");bq=bw.height();bw.css("height",bt);bw.placeholdme("revert");z(bp,false);bw.trigger("show")}else{z(bp,true);bw.addClass("collapsed").trigger("hide")}bw.animate({height:bq},{duration:bl,easing:bn,complete:bs})}})}function a3(){F.tasksStarted=[];F.tasksCompleted=[];S.signals.onWorkerReset.dispatch()}function q(bi){if(typeof bi==="string"&&bi.length>0&&F.tasksStarted.hasOwnProperty(bi)!==true){F.taskCount++;F.tasksStarted.push(bi);S.signals.onWorkerTaskStarted.dispatch(bi)}}function aR(bj){var bi=X(F.tasksStarted,bj);if(bi!==-1){F.tasksStarted.splice(bi,1);F.tasksCompleted.push(bj);S.signals.onWorkerTaskCompleted.dispatch(bj);if(F.tasksStarted.length===0){S.signals.onWorkerTasksCompleted.dispatch()}}}function i(bm,bj,br,bp){var bn,bk,bq,bt,bi,bo,bs=true,bl;if(typeof bm!=="undefined"){if(typeof bm==="string"||bm.hasOwnProperty("length")===false){bm=[bm]}bm=bm.slice(0);if(typeof br!=="string"||O.listLocations.hasOwnProperty(br)){br=O.listCount}O.listCount++;for(bn=0,bk=bm.length;bn<bk;bn++){bq=bm[bn];bt=N(bq);bi=X(O.loading,bt);bo=X(O.loaded,bt);if(bi===-1&&bo==-1){O.loading.push(bt);O.loadingListIDs.push(br);q(bt);newLocations=true}if(bo===-1){bs=false}}O.loadingOrLoaded=O.loaded.concat(O.loading);O.listLocations[br]=bm;if(typeof bj==="undefined"){bj=[]}else{if(typeof bj==="function"||bj.hasOwnProperty("length")===false){bj=[bj]}}O.listCallbacks[br]=bj;if(typeof bp!=="string"){bp=O.tips[Math.max(0,Math.min(O.tips.length-1,Math.round(Math.random()*O.tips.length)-1))]}O.listMessages[br]=bp;O.listLoaded[br]=[];O.lists.push(br);if(bs===true){aY(br)}else{U()}}}function U(){var bk,bj,bm,bi,bl;if(O.active===false&&O.lists.length>0){O.active=true;O.listCurrent=O.lists[0];bm=O.listLocations[O.listCurrent].slice(0);for(bk=0,bj=bm.length;bk<bj;bk+=1){bi=bm[bk];bl=N(bi);if(X(O.loaded,bl)!==-1){l(bi)}else{if(X(O.started,bl)===-1){O.started.push(bl);G(bi)}}}}else{O.listCurrent=undefined;S.signals.onLoadAllCompleted.dispatch()}}function G(bi){var bm,bk,bn,bl,bo=function(){l(bi,bl)},bj=function(bp){l(bi,bp)};if(typeof bi!=="undefined"){bn=bi.type||O.loadTypeBase;bm=N(bi);bk=aQ(bm);if(bk===""){bm=v(bm)}if(bn==="image"||a5(bk)){bl=ab(bm,function(bp){bl=bp;bo()});ae(bm,{data:bl})}else{if(bn==="model"||bn==="model_ascii"){if(typeof O.threeJSON==="undefined"){O.threeJSON=new THREE.JSONLoader(true)}O.threeJSON.load(bm,bj)}else{$LAB.script(bm).wait(bo)}}}}function l(bq,bk){var bl,bi,br,bj,bn,bo,bs,bp,bm;bs=N(bq);bp=o(bq);aR(bs);ae(bs,{data:bk});M(bs);if(typeof S!=="undefined"){S.signals.onLoadItemCompleted.dispatch(bs)}for(bl=0,bi=O.lists.length;bl<bi;bl++){br=O.lists[bl];bj=O.listLocations[br];bo=X(bj,bq);if(bo!==-1){bn=O.listLoaded[br];bj.splice(bo,bo!==-1?1:0);bn.push(bq);if(bj.length===0){bm=bm||[];bm.push(br)}}}if(typeof bm!=="undefined"){for(bl=0,bi=bm.length;bl<bi;bl++){aY(bm[bl])}}}function aY(bk){var bl,bj,bi,bn,bm;bm=X(O.lists,bk);if(bm!==-1){O.lists.splice(bm,1)}bi=O.listCallbacks[bk];for(bl=0,bj=bi.length;bl<bj;bl++){bn=bi[bl];if(typeof bn!=="undefined"){bn.call(this)}}if(typeof S!=="undefined"){S.signals.onLoadListCompleted.dispatch(bk)}delete O.listLocations[bk];delete O.listCallbacks[bk];delete O.listMessages[bk];delete O.listLoaded[bk];O.active=false;U()}function M(bp){var bm,bj,bi,bo,bk,bl,bn=false;bp=a7(bp);for(bm=0,bj=bp.length;bm<bj;bm++){bi=bp[bm];bo=N(bi);bl=X(O.loading,bo);if(bl!==-1){O.loadingListIDs.splice(bl,1);O.loading.splice(bl,1)}bk=X(O.loaded,bo);if(bk===-1){O.loaded.push(bo);bn=true}}if(bn===true){O.loadingOrLoaded=O.loaded.concat(O.loading)}}function aF(bi,bk){var bl,bj;bl=N(bi);bj=X(bk,bl);if(bj!==-1){return true}else{return false}}function aL(bi){return aF(bi,O.loadingOrLoaded)}function p(bi){return aF(bi,O.loaded)}function w(bi){return aF(bi,O.loading)}function o(bi){return bi.type||O.loadTypeBase}function N(bi){return bi.path||bi}function aQ(bi){var bl,bk,bj="";bl=N(bi);bk=bl.lastIndexOf(".");if(bk!==-1){bj=bl.substr(bk+1).toLowerCase()}return bj}function v(bi){var bj=E(bi);bj=bj.replace(/\./g,"")+".js";return bj}function E(bi){var bk,bj;bk=N(bi);bj=bk.lastIndexOf(".");if(bj!==-1){bk=bk.substr(0,bj)}return bk}function a(bi){var bk,bj;bk=N(bi);bj=aQ(bk);if(bj===""){return v(bk)}else{return E(bk)}}function n(bn){var bl,bi,bj,bk,bm;bj=bn.split(/[\\\/]/);for(bl=0,bi=bj.length;bl<bi;bl++){bk=bj[bl];bk=bk.replace(/[^\w\.-]+/g,"");if(bk===""){aS("Invalid asset cascade","Main","N/A");return}bj[bl]=bk}return bj}function av(bn,bo){var bq,bl,bm,bp,bj,bk,bi;bj=bm=r;bq=N(bn);bl=n(bq);for(bk=0,bi=bl.length;bk<bi;bk++){bm=bj;bp=bl[bk];bj=bm[bp];if(typeof bj==="undefined"){break}}bo=bo||1;if(typeof bj==="undefined"){if(bo===1){return av(a(bq),bo+1)}}return bj}function C(bq,bo){var bs,bn,bp,br,bk,bm,bi,bl,bj;if(bo instanceof bf){bk=bp=r;bs=N(bq);bn=n(bs);for(bl=0,bj=bn.length;bl<bj;bl++){bp=bk;br=bn[bl];bk=bp[br]=bp[br]||{}}if(bk instanceof bf&&bk.is_empty()===false){if(bo.is_empty()===false){bk.merge_asset_self(bo)}}else{bp[br]=bk=bo}}return bk}function d(bi){var bj,bk;bj=av(bi);bk=(bj instanceof bf)?bj.data:bj;return bk}function ae(bk,bj){var bi,bm,bl=av(bk);if(bl instanceof bf!==true||(bj&&typeof bj.data!=="undefined"&&bj.data!==bl.data)){bi=new bf(bk,bj);bm=bi.data}else{bm=bl.data}return bm}function af(bl,bk){var bj,bi;bk=bk||av(bl);if(bk instanceof bf){bk.ready=true;bk.wait=false;if(typeof S.signals!=="undefined"&&typeof S.signals.onAssetReady!=="undefined"){S.signals.onAssetReady.dispatch(bl)}}}function ba(bo,bn,bs,br){var bk,bm,bq,bl=[],bj=[],bi=[],bp=false;bo=a7(bo);bn=a7(bn);bm=function(bv,bu){var bt;bt=X(bj,bv);if(bt!==-1){bj.splice(bt,1);bi.push(bv);if(bj.length===0&&bi.length===bo.length){if(bp===true){S.signals.onAssetReady.remove(bm);bp=false}bq()}}else{if(bu!==true){bm(a(bv),true)}}};bq=function(){var bu,bt,bv;for(bu=0,bt=bn.length;bu<bt;bu++){bv=bn[bu];bv.apply(this,bl)}if(br instanceof bf&&br.readyAutoUpdate===true){br.on_ready()}};bk=function(){var bv,bu,bt,bx,bw;for(bv=0,bu=bo.length;bv<bu;bv++){bt=bo[bv];bx=N(bt);bw=av(bt);if(bw instanceof bf){bl.push(bw.data)}if(bs===true){bj.push(bx);if(bw instanceof bf&&bw.ready===true){bm(bx)}else{if(bp===false){bp=true;S.signals.onAssetReady.add(bm)}}}}if(bs!==true||bo.length===0){bq()}};i(bo,bk)}function bf(bk,bj){var bi=this;bj=bj||{};bj.path=bk;bi.merge_asset_self(bj,true);if(typeof bi.path!=="undefined"){bi=C(bi.path,bi);if(bi===this&&this.readyAutoUpdate===true&&(this.requirements.length===0||this.wait!==true)){this.on_ready()}if(this.requirements.length>0){ba(this.requirements,this.callbacksOnReqs,this.wait,this)}}return bi}bf.prototype=new Object();bf.prototype={constructor:bf,merge_asset_self:function(bj,bi){var bk;if(typeof bj!=="undefined"){this.path=bj.path;this.merge_asset_data_self(bj);if(typeof this.wait!=="boolean"||this.wait===false){if(bj.wait===true){this.wait=bj.wait}else{this.wait=false}}if(this.ready!==true){this.ready=false}if(typeof this.readyAutoUpdate!=="boolean"){if(bj.hasOwnProperty("readyAutoUpdate")){this.readyAutoUpdate=bj.readyAutoUpdate}else{this.readyAutoUpdate=true}}this.requirements=a7(this.requirements);this.callbacksOnReqs=a7(this.callbacksOnReqs);if(bi===true){this.requirements=this.requirements.concat(a7(bj.requirements));this.callbacksOnReqs=this.callbacksOnReqs.concat(a7(bj.callbacksOnReqs))}}},merge_asset_data_self:function(bj){var bi=bj.data;if(typeof bi!=="undefined"){if(typeof this.data==="undefined"||b(bi)){this.data=bi}else{ar(bi,this.data)}}},is_empty:function(){var bi=true;if(typeof this.data!=="undefined"||(this.ready===false&&this.requirements.length>0)){bi=false}return bi},on_ready:function(){console.log("[ KAIOPUA ] Module / Asset Ready: "+this.path);af(this.path,this)}};return r}(KAIOPUA||{}));