(function(q){var b=q.shared=q.shared||{},G="js/kaiopua/ui/UI.js",F={},m,C=false,s=false,H=1000,c,B,r;q.asset_register(G,{data:F,requirements:["js/kaiopua/ui/UIQueue.js","js/lib/jquery.scrollbarwidth.min.js","js/lib/jquery.multi-sticky.js"],callbacksOnReqs:y,wait:true});function y(I){m=I;F.pause=p;F.resume=e;F.resize=D;F.show_error=d;Object.defineProperty(F,"ready",{get:function(){return s}});b.domElements=b.domElements||{};b.domElements.cloneables=b.domElements.cloneables||{};b.domElements.$uiGameDimmer=$("#uiGameDimmer");b.domElements.$uiBlocker=$("#uiBlocker");b.domElements.$ui=$("#ui");b.domElements.$uiInGame=$("#uiInGame");b.domElements.$uiOverGame=$("#uiOverGame");b.domElements.$uiOutGame=$("#uiOutGame");b.domElements.$uiOverlay=$("#uiOverlay");b.domElements.$autoCenter=$(".auto-center");b.domElements.$autoCenterVertical=$(".auto-center-vertical");b.domElements.$autoCenterHorizontal=$(".auto-center-horizontal");b.domElements.$preloader=$("#preloader");b.domElements.$statusInactive=$("#statusInactive");b.domElements.$statusActive=$("#statusActive");b.domElements.$statusItems=$(".status-item");b.domElements.$worker=$("#worker");b.domElements.$workerProgressBarStarted=$("#workerProgressBarStarted");b.domElements.$workerProgressBarCompleted=$("#workerProgressBarCompleted");b.domElements.$uiState=$("#uiState");b.domElements.$gameState=$("#gameState");b.domElements.$dropdowns=$(".dropdown");b.domElements.$tabToggles=$(".tab-toggles").find('[href^="#"]').not(".tab-toggle-empty");b.domElements.$stickied=$(".is-sticky");b.domElements.$actionsActive=$("#actionsActive");b.domElements.$actionsInactive=$("#actionsInactive");b.domElements.$actionItems=$(".action-item");b.domElements.$menus=$(".menu");b.domElements.$menuDefault=$("#menuMain");b.domElements.$menusInner=$();b.domElements.$menuToggles=$();b.domElements.$menuToggleDefault=$();b.domElements.$menuActive=$("#menuActive");b.domElements.$menuInactive=$("#menuInactive");b.domElements.$navbars=$(".navbar, .subnavbar");b.domElements.$navMenus=$("#navMenus");b.domElements.$navMain=$("#navMain");b.domElements.$navMainAlt=$("#navMainAlt");b.domElements.$social=$("#social");b.domElements.$sponsors=$("#sponsors");b.domElements.$sponsorsLite=$("#sponsorsLite");b.domElements.$buttonsGameStart=$(".game-start");b.domElements.$buttonsGameStop=$(".game-stop");b.domElements.$buttonsGamePause=$(".game-pause");b.domElements.$buttonsGameResume=$(".game-resume");$("img").attr("draggable",false);$('a[href^="#"]').each(function(){var K=$(this),L=$(K.data("section")),J=$(K.attr("href"));K.attr("onclick","return false;");if(L.length>0||J.length>0){K.on("tap",function(){(L[0]||J[0]).scrollIntoView(true)})}});if(b.supports.pointerEvents===false){q.dom_ignore_pointer($(".ignore-pointer, .disabled"),true)}b.domElements=b.domElements||{};for(i=0,l=b.errorTypes.length;i<l;i++){errorName=b.errorString+b.errorTypes[i];b.domElements["$"+errorName]=$("#"+errorName)}b.domElements.$worker.on("hidden.reset",function(){q.worker_reset()});b.domElements.$statusItems.each(function(){var J=$(this);if(J.is(".hidden, .collapsed")){b.domElements.$statusInactive.append(J)}}).on("show.active",function(){b.domElements.$statusActive.append(this)}).on("hidden.active",function(){b.domElements.$statusInactive.append(this)});b.domElements.$actionItems.each(function(){var J=$(this);if(J.parent().is(b.domElements.$actionsActive)&&J.is(".hidden, .collapsed")){b.domElements.$actionsInactive.append(J)}}).on("show.active",function(){b.domElements.$actionsActive.append(this)}).on("hidden.active",function(){b.domElements.$actionsInactive.append(this)});b.domElements.$dropdowns.each(function(){var J=$(this);J.find(".dropdown-menu a").each(function(){var K=$(this);K.on("tap",function(){K.parent().removeClass("active");J.removeClass("open")})})});b.domElements.$navbars.each(function(){var L=$(this),K=L.find('[data-toggle="collapse"]'),J=L.find(".nav-collapse");if(K.length>0&&J.length>0){J.find("a").each(function(){var M=$(this);M.on("tap",function(){if(K.is(".collapsed")!==true){K.trigger("click")}})})}});b.domElements.$stickied.each(function(){var K=$(this),L=$(K.data("relative")),J=$(K.data("target"));if(J.length===0){J=b.domElements.$uiOutGame}K.removeClass("is-sticky").sticky({topSpacing:function(){return L.offset().top+L.outerHeight(true)},scrollTarget:J,handlePosition:false})});b.domElements.$menus.each(function(){var J=$(this),S=J.find(".menu-inner"),K=b.domElements.$tabToggles.filter('[href="#'+J.attr("id")+'"]'),M,L,O,Q,P,R,N;J.data("$inner",S);J.data("$toggle",K);J.data("scrollTop",0);b.domElements.$menusInner=b.domElements.$menusInner.add(S);M=function(){o(false,J);if(K.length>0){K.closest("li").addClass("active")}J.addClass("active");q.dom_fade({element:J,opacity:1});$(window).trigger("resize");b.domElements.$uiOutGame.scrollTop(J.data("scrollTop"))};L=function(){J.data("scrollTop",b.domElements.$uiOutGame.scrollTop());if(K.length>0){K.closest("li").removeClass("active")}J.removeClass("active");q.dom_fade({element:J,duration:0})};O=function(){o(false,J)};Q=function(){z()};P=function(){m.add({element:J,container:b.domElements.$uiOutGame,activate:M,deactivate:L,first:O,last:Q})};R=function(){m.remove(J)};N=function(){if(J.is(".active")===true){J.trigger("close")}else{J.trigger("open")}};J.on("open",P).on("close",R).on("toggle",N);if(K.length>0){K.data("$menu",J);b.domElements.$menuToggles=b.domElements.$menuToggles.add(K);K.on("tap",N)}if(J.is(".active")===true){b.domElements.$menuDefault=J;b.domElements.$menuToggleDefault=K}});if(b.domElements.$sponsors.length>0&&b.domElements.$sponsorsLite.length>0){b.domElements.$sponsorsLite.html(b.domElements.$sponsors.clone().html())}b.domElements.$buttonsGameStop.on("tap",q.stop);b.domElements.$buttonsGamePause.on("tap",o);b.domElements.$buttonsGameResume.on("tap",z);b.signals.onError.add(d);b.signals.onGameInput.add(k);b.signals.onWorkerReset.add(A);b.signals.onWorkerTaskStarted.add(t);b.signals.onWorkerTaskCompleted.add(j);b.signals.onWorkerTasksCompleted.add(u);b.signals.onGameStateChange.add(x);b.signals.onGameStarted.add(n);b.signals.onGameStartedCompleted.add(a);b.signals.onGameStopped.add(v);b.signals.onGameStoppedCompleted.add(g);b.signals.onGamePaused.add(p);b.signals.onGameResumed.add(e);s=true;b.domElements.$uiState.find(".state-loading").removeClass("active").end().find(".state-usable").removeClass("active").end().find(".state-ready").addClass("active");$(window).trigger("resize");b.domElements.$menuDefault.trigger("open");q.dom_fade({element:b.domElements.$preloader,duration:0});q.dom_fade({element:b.domElements.$uiGameDimmer});q.dom_fade({element:b.domElements.$navMain,opacity:1});E()}function A(){$().add(b.domElements.$workerProgressBarStarted).add(b.domElements.$workerProgressBarCompleted).children(".work-task").remove()}function t(I){if(typeof c!=="undefined"){window.clearTimeout(c);c=undefined}q.dom_collapse({element:b.domElements.$worker,show:true});b.domElements.$workerProgressBarStarted.prepend($('<img src="img/bar_vertical_rev_64.png" id="'+I+'" class="iconk-tiny-widthFollow-tight work-task">'))}function j(J){var I=J.replace(/([ #;?&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1");b.domElements.$workerProgressBarStarted.find("#"+I).remove();b.domElements.$workerProgressBarCompleted.append($('<img src="img/bar_vertical_rev_64.png" id="'+J+'" class="iconk-tiny-widthFollow-tight work-task">'))}function u(){if(typeof c!=="undefined"){window.clearTimeout(c);c=undefined}c=window.setTimeout(function(){q.dom_collapse({element:b.domElements.$worker})},H)}function x(){if(q.playable===true&&b.supports.webGL===true){b.domElements.$gameState.find(".state-loading").removeClass("active");if(q.ready===true){b.domElements.$gameState.find(".state-usable").removeClass("active").end().find(".state-ready").addClass("active")}else{b.domElements.$gameState.find(".state-ready").removeClass("active").end().find(".state-usable").addClass("active")}h()}else{b.domElements.$gameState.find(".state-loading").addClass("active").end().find(".state-usable").removeClass("active").end().find(".state-ready").removeClass("active");E()}}function h(){var I,J,K;I=$().add(b.domElements.$buttonsGameStart).add(b.domElements.$buttonsGameStop);J=I.closest("li");if(J.length===0){J=I}J.removeClass("disabled dim");b.domElements.$buttonsGameStart.tooltip("destroy").on("tap",q.start)}function E(){var I,J,K;I=$().add(b.domElements.$buttonsGameStart).add(b.domElements.$buttonsGameStop);J=I.closest("li");if(J.length===0){J=I}J.addClass("disabled dim");if(b.supports.webGL!==true){b.domElements.$gameState.find(".state-loading").text("No WebGL");b.domElements.$buttonsGameStart.tooltip("destroy").tooltip({title:"We need WebGL!",trigger:"manual",placement:"left",selector:b.domElements.$buttonsGameStart}).tooltip("show");J=b.domElements.$buttonsGameStart.closest("li");if(J.length===0){J=b.domElements.$buttonsGameStart}K=b.domElements.$buttonsGameStart.data("tooltip").$tip;K.css({top:(J.height()-K.height())*0.5,left:-(K.outerWidth()+5)}).appendTo(J)}}function n(){e()}function a(){}function v(){}function g(){q.dom_fade({element:b.domElements.$navMain,opacity:1})}function f(){if(q.started!==true){b.domElements.$uiGameDimmer.off(".resume");q.dom_fade({element:b.domElements.$uiGameDimmer})}q.dom_fade({element:b.domElements.$navMainAlt,duration:0});if(b.domElements.$menuToggleDefault.length>0){b.domElements.$menuToggleDefault.trigger("tap")}else{if(b.domElements.$menuDefault.length>0){b.domElements.$menuDefault.trigger("open")}}}function k(K,I,J){if(J==="up"){if(I==="escape"){if((q.started===true&&q.paused===true)||C===true){z()}else{o()}}}}function o(I,J){if(q.started===true){if(q.paused!==true){q.pause(I,J)}else{p(I,J)}}else{p(I,J)}}function p(K,L){var I=L instanceof jQuery,J=I&&!b.domElements.$menuDefault.is(L);C=true;q.dom_fade({element:b.domElements.$buttonsGamePause,duration:0,invisible:true});q.dom_fade({element:b.domElements.$buttonsGameResume,duration:0,invisible:true});if(K===true){q.dom_fade({element:b.domElements.$uiBlocker,opacity:0.9})}else{if(J===true){B=L;b.domElements.$social.addClass("blocking");b.domElements.$sponsorsLite.addClass("hidden");q.dom_fade({element:b.domElements.$navMainAlt,opacity:1})}else{B=undefined;f()}if(q.started===true||J===true){q.dom_fade({element:b.domElements.$uiGameDimmer,opacity:0.9});b.domElements.$uiGameDimmer.on("tap.resume",e);q.dom_fade({element:b.domElements.$buttonsGameResume,opacity:1})}}}function z(){if(q.started===true&&typeof B==="undefined"){q.resume()}else{e()}}function e(I){C=false;q.dom_fade({element:b.domElements.$uiBlocker});if(I!==true){if(typeof B!=="undefined"){b.domElements.$social.removeClass("blocking");b.domElements.$sponsorsLite.removeClass("hidden");f()}else{b.domElements.$uiGameDimmer.off(".resume");q.dom_fade({element:b.domElements.$uiGameDimmer});if(q.started===true){m.clear(b.domElements.$uiOutGame);q.dom_fade({element:b.domElements.$uiOutGame});q.dom_fade({element:b.domElements.$buttonsGamePause,opacity:1})}else{f()}}}if(q.started===true&&q.paused!==true){q.dom_fade({element:b.domElements.$buttonsGamePause,opacity:1})}else{if(typeof B!=="undefined"){q.dom_fade({element:b.domElements.$buttonsGameResume,opacity:1})}else{q.dom_fade({element:b.domElements.$buttonsGameResume,duration:0,invisible:true})}}}function d(K,J,I){var L=K,M;w();if(q.index_of_value(b.errorTypes,L)===-1){L=b.errorTypeGeneral}M=q.index_of_value(b.errorTypesOnlyOnce,L);if(M!==-1){if(window.localStorage){if(typeof window.localStorage[L]!=="undefined"){return}else{window.localStorage[L]="shown"}}$(window).one("click.errorclear",function(){w();z()})}r=b.domElements["$"+b.errorString+L];if(L===b.errorTypeGeneral){if(typeof J==="string"){index=J.search(/\/(?![\s\S]*\/)/);if(index!==-1){J=J.slice(index+1)}index=J.search(/\?(?![\s\S]*\?)/);if(index!==-1){J=J.slice(0,index)}}r.find("#errorMessage").html(K);r.find("#errorFile").html(J);r.find("#errorLine").html(I)}o(true);q.dom_collapse({element:r,show:true})}function w(){if(typeof r!=="undefined"){q.dom_collapse({element:r})}}function D(){if(b.domElements.$uiOutGame[0].scrollHeight>b.screenViewableHeight){b.domElements.$menusInner.css("padding-left",$.scrollbarWidth())}}}(KAIOPUA));